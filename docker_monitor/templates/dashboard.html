<!doctype html>
<html ng-app="dashboard">
<head>
<meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/static/content/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/static/content/site.css" />
</head>
<body ng-controller="host_list">
    <div class="container body-content">
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <a class="navbar-brand" href="{{ url_for('dashboard') }}">Docker Monitor</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling --> 
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            {% if host_addr and img_history or inspect or container_logs %}
             <li><a href="{{ url_for('index', host_addr=host_addr) }}">Back ({{ host_addr }})</a></li>
            {% endif %}
          </ul>
        </div> 
      </div> 
    </nav>
    <table border="1" id="hl" class="table table-inverse">
        <thead>
        <tr style='background:black; color: white'>
            <td>Host Name</td>
            <td>Host Address</td>
            <td>Conect Status</td>
        </tr>
        </thead>
        <tbody>
            <tr ng-repeat="item in data">
               <td><a href="[[ item.link ]]">[[ item.host_name ]]</a></td>
               <td>[[ item.host_addr   ]]</td>
               <td style="color:[[ item.status_color ]]">[[ item.host_status ]]</td>
            </tr>
        </tbody>
    </table>
    <div id="progress" class="hide">
      <div class="cssload-thecube">
          <div class="cssload-cube cssload-c1"></div>
          <div class="cssload-cube cssload-c2"></div>
          <div class="cssload-cube cssload-c4"></div>
          <div class="cssload-cube cssload-c3"></div>
       </div>
    </div>
    </div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<script type="text/javascript"> 
    var app = angular.module('dashboard', [], function($interpolateProvider) {
      $interpolateProvider.startSymbol('[[');
      $interpolateProvider.endSymbol(']]');
    });

    let element = document.getElementById('hl')
    element.className = 'hide'

    let prog = document.getElementById('progress')
    prog.className = 'show'

    app.controller('host_list', function ($scope, $http) {
      $http.get("/get_host_list").then(function(res,status,xhr) {
        element.className = 'table table-inverse'
        prog.className = 'hide'
        item = []
        for (let host_obj of res.data) {
              if (host_obj.status){
                    status = 'Connected'
                    status_color = "green"
              }else{
                    status = 'Disconnected'
                    status_color = "red"
              }
              item.push({
                'host_name': host_obj.host_name,
                'host_addr': host_obj.addr,
                'host_status': status,
                'status_color': status_color,
                'link': "{{ url_for('index') }}" + "?host_addr=" + host_obj.addr
                })
        }
        $scope.data = item
      });
    });

</script>
</html>

